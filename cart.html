<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Giỏ hàng</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background:#f8f9fa; }
h2 { margin-top:0; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
th, td { padding: 12px; border-bottom: 1px solid #eee; text-align:center; vertical-align:middle; }
img { width:80px; height:auto; border-radius:6px; }
button { cursor:pointer; }
input.qty { width:50px; text-align:center; border-radius:6px; border:1px solid #ccc; padding:5px; }
#grand-total { margin-top:20px; font-size:18px; font-weight:bold; }
</style>
</head>
<body>
<h2>Giỏ hàng của bạn</h2>

<table id="cart-table">
  <thead>
    <tr>
      <th>Ảnh</th>
      <th>Sản phẩm</th>
      <th>Giá</th>
      <th>Số lượng</th>
      <th>Tổng</th>
      <th>Xóa</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<h3 id="grand-total">Tổng cộng: 0₫</h3>

<script>
// Load giỏ hàng từ localStorage
function loadCart() {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const tbody = document.querySelector("#cart-table tbody");
  tbody.innerHTML = "";
  let grandTotal = 0;

  cart.forEach((item, index) => {
    const total = item.price * item.quantity;
    grandTotal += total;

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><img src="${item.image}" alt="${item.name}"></td>
      <td>${item.name}</td>
      <td>${item.price.toLocaleString()}₫</td>
      <td>
        <button onclick="changeQty(${index}, -1)">-</button>
        <input class="qty" type="number" value="${item.quantity}" min="1" onchange="updateQty(${index}, this.value)">
        <button onclick="changeQty(${index}, 1)">+</button>
      </td>
      <td id="total-${index}">${total.toLocaleString()}₫</td>
      <td><button onclick="removeItem(${index})" style="padding:5px 10px; border-radius:6px; border:none; background:#dc3545; color:#fff;">Xóa</button></td>
    `;
    tbody.appendChild(tr);
  });

  document.getElementById("grand-total").innerText = `Tổng cộng: ${grandTotal.toLocaleString()}₫`;
}

// Thay đổi số lượng
function changeQty(index, delta) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart[index].quantity += delta;
  if(cart[index].quantity < 1) cart[index].quantity = 1;
  localStorage.setItem("cart", JSON.stringify(cart));
  loadCart();
}

// Cập nhật số lượng khi input thay đổi
function updateQty(index, value) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart[index].quantity = parseInt(value) || 1;
  localStorage.setItem("cart", JSON.stringify(cart));
  loadCart();
}

// Xóa sản phẩm
function removeItem(index) {
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart.splice(index,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  loadCart();
}

// Load giỏ hàng khi mở trang
loadCart();
</script>
</body>
</html>
